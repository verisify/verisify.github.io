<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Week Selection Date Picker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <link href="https://unpkg.com/flatpickr/dist/flatpickr.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.7/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
    <script src="https://unpkg.com/flatpickr"></script>
    <style>
        .input-group input {
            padding-left: 40px; /* Adjust as needed to fit the icon */
        }
        .input-group .calendar-icon {
            position: absolute;
            left: 10px; /* Adjust as needed to align the icon */
            top: 50%;
            transform: translateY(-50%);
            z-index: 10;
        }
    </style>
</head>
<body>

<div class="container mt-5">
    <div class="input-group mb-3">
        <input type="text" id="weekPicker" class="form-control" placeholder="Select a week">
        <i class="bi bi-calendar-date calendar-icon"></i>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var today = new Date();
    var weekStart = new Date(today);
    weekStart.setDate(weekStart.getDate() - weekStart.getDay()); // Adjust to Sunday
    var weekEnd = new Date(weekStart.getTime() + 6 * 24 * 60 * 60 * 1000); // Advance to Saturday

    flatpickr("#weekPicker", {
        mode: "range",
        dateFormat: "l, F j",
        defaultDate: [weekStart, weekEnd],
        enableTime: false,
        locale: {
            firstDayOfWeek: 0
        },
        maxDate: weekEnd, // Restrict date selection to current week and earlier
        onChange: function(selectedDates, dateStr, instance) {
            if (selectedDates.length > 0) {
                var selectedDate = selectedDates[0];
                var weekStart = new Date(selectedDate);
                weekStart.setDate(weekStart.getDate() - weekStart.getDay()); // Adjust to Sunday
                var weekEnd = new Date(weekStart.getTime() + 6 * 24 * 60 * 60 * 1000); // Advance to Saturday
                instance.setDate([weekStart, weekEnd]);
            }
        },
        onClose: function(selectedDates, dateStr, instance) {
            if (selectedDates.length !== 2 || selectedDates[0].getDay() !== 0 || selectedDates[1].getDay() !== 6) {
                alert("Please select a full week starting from Sunday.");
                instance.clear();
            }
        }
    });
});
</script>

</body>
</html>
